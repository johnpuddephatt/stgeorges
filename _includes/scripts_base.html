<script src="https://www.google.com/recaptcha/api.js" async defer></script>
<script>
  if (document.forms[0] && window.FormData) {
    for (var i = 0; i < document.forms.length; i++) {
      var message = new Object();
      message.loading = "Sending message...";
      message.success =
        "<h3>Thank you for your message.</h3><p>Weâ€™ll get back to you as soon as we can.</p>";
      message.failure = "Error. Message not sent.";

      var form = document.forms[i];
      var formAction = form.getAttribute("action");
      var statusMessage = document.createElement("div");
      statusMessage.innerHTML = message.loading;
      statusMessage.classList.add('message');
      statusMessage.classList.add('status');

      // Set up the AJAX request
      var request = new XMLHttpRequest();

      // Listen for the form being submitted
      form.addEventListener("submit", function(evt) {
        request.open("POST", formAction, true);
        request.setRequestHeader("accept", "application/json");
        evt.preventDefault();
        console.log(statusMessage);
        form.insertAdjacentElement('afterbegin',statusMessage);

        // Create a new FormData object passing in the form's key value pairs (that was easy!)
        var formData = new FormData(form);

        // Send the formData
        request.send(formData);

        // Watch for changes to request.readyState and update the statusMessage accordingly
        request.onreadystatechange = function() {
          // <4 =  waiting on response from server
          if (request.readyState < 4) {
            statusMessage.innerHTML = message.loading;
          }
          else if (request.readyState === 4) {
            // 4 = Response from server has been completely loaded.
            // 200 - 299 = successful
            if (request.status == 200 && request.status < 300) {
              statusMessage.innerHTML = message.success;
            }
            else {
              statusMessage[i].innerHTML = message.failure;
            }
          }
        };
      });
    }
  }
</script>